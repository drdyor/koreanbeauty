class u{constructor(t){this.canvas=t,this.gl=null,this.program=null,this.animationId=null,this.startTime=0,this.isRunning=!1,this.patterns={alpha:{frequency:10,color:[.2,.6,1],intensity:.7},theta:{frequency:6,color:[.8,.2,1],intensity:.6},delta:{frequency:2,color:[.1,.3,.8],intensity:.5},beta:{frequency:20,color:[1,.8,.2],intensity:.8},gamma:{frequency:40,color:[1,.4,.6],intensity:.9},schumann:{frequency:7.83,color:[.4,.8,.4],intensity:.6},solfeggio_396:{frequency:396/50,color:[.8,.2,.2],intensity:.7},solfeggio_528:{frequency:528/50,color:[.2,.8,.2],intensity:.7},solfeggio_741:{frequency:741/50,color:[.2,.2,.8],intensity:.7},anxiety_relief:{frequency:8.5,color:[.3,.7,.9],intensity:.6},confidence_boost:{frequency:12,color:[1,.6,.2],intensity:.8},authority_balance:{frequency:9.5,color:[.7,.3,.8],intensity:.7}},this.currentPattern="alpha",this.intensity=1,this.initWebGL()}initWebGL(){try{if(this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl"),!this.gl)throw new Error("WebGL not supported");const t=`
        attribute vec2 a_position;
        void main() {
          gl_Position = vec4(a_position, 0.0, 1.0);
        }
      `,e=`
        precision mediump float;
        uniform float u_time;
        uniform float u_frequency;
        uniform vec3 u_color;
        uniform float u_intensity;
        uniform vec2 u_resolution;
        
        void main() {
          vec2 uv = gl_FragCoord.xy / u_resolution;
          
          // Generate frequency-based oscillation
          float wave = sin(u_time * u_frequency * 6.28318530718);
          
          // Create radial gradient for better visual effect
          vec2 center = vec2(0.5, 0.5);
          float dist = distance(uv, center);
          float radial = 1.0 - smoothstep(0.0, 0.7, dist);
          
          // Combine wave and radial for therapeutic effect
          float brightness = (wave * 0.5 + 0.5) * radial * u_intensity;
          
          // Apply color with brightness modulation
          vec3 finalColor = u_color * brightness;
          
          gl_FragColor = vec4(finalColor, 1.0);
        }
      `,i=this.createShader(this.gl.VERTEX_SHADER,t),n=this.createShader(this.gl.FRAGMENT_SHADER,e);this.program=this.createProgram(i,n);const s=new Float32Array([-1,-1,1,-1,-1,1,1,1]),r=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.STATIC_DRAW),this.positionLocation=this.gl.getAttribLocation(this.program,"a_position"),this.timeLocation=this.gl.getUniformLocation(this.program,"u_time"),this.frequencyLocation=this.gl.getUniformLocation(this.program,"u_frequency"),this.colorLocation=this.gl.getUniformLocation(this.program,"u_color"),this.intensityLocation=this.gl.getUniformLocation(this.program,"u_intensity"),this.resolutionLocation=this.gl.getUniformLocation(this.program,"u_resolution"),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0)}catch(t){console.error("WebGL initialization failed:",t),this.fallbackToCanvas2D()}}createShader(t,e){const i=this.gl.createShader(t);return this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.error("Shader compilation error:",this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),null)}createProgram(t,e){const i=this.gl.createProgram();return this.gl.attachShader(i,t),this.gl.attachShader(i,e),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?i:(console.error("Program linking error:",this.gl.getProgramInfoLog(i)),this.gl.deleteProgram(i),null)}fallbackToCanvas2D(){console.warn("Falling back to Canvas 2D for light frequency generation"),this.useCanvas2D=!0,this.ctx=this.canvas.getContext("2d")}start(t="alpha"){this.isRunning&&this.stop(),this.currentPattern=t,this.isRunning=!0,this.startTime=performance.now(),this.gl&&this.program?this.renderWebGL():this.useCanvas2D&&this.renderCanvas2D()}stop(){this.isRunning=!1,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.gl?(this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT)):this.ctx&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}renderWebGL(){if(!this.isRunning)return;const t=(performance.now()-this.startTime)/1e3,e=this.patterns[this.currentPattern];this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.useProgram(this.program),this.gl.uniform1f(this.timeLocation,t),this.gl.uniform1f(this.frequencyLocation,e.frequency),this.gl.uniform3fv(this.colorLocation,e.color),this.gl.uniform1f(this.intensityLocation,e.intensity*this.intensity),this.gl.uniform2f(this.resolutionLocation,this.canvas.width,this.canvas.height),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.animationId=requestAnimationFrame(()=>this.renderWebGL())}renderCanvas2D(){if(!this.isRunning)return;const t=(performance.now()-this.startTime)/1e3,e=this.patterns[this.currentPattern],n=(Math.sin(t*e.frequency*2*Math.PI)*.5+.5)*e.intensity*this.intensity,s=Math.floor(e.color[0]*n*255),r=Math.floor(e.color[1]*n*255),c=Math.floor(e.color[2]*n*255),a=this.canvas.width/2,o=this.canvas.height/2,g=Math.min(a,o),h=this.ctx.createRadialGradient(a,o,0,a,o,g);h.addColorStop(0,`rgb(${s}, ${r}, ${c})`),h.addColorStop(1,"rgb(0, 0, 0)"),this.ctx.fillStyle=h,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.animationId=requestAnimationFrame(()=>this.renderCanvas2D())}setPattern(t){this.patterns[t]&&(this.currentPattern=t)}setIntensity(t){this.intensity=Math.max(0,Math.min(1,t))}getAvailablePatterns(){return Object.keys(this.patterns)}getPatternInfo(t){return this.patterns[t]}cleanup(){this.stop(),this.gl&&this.program&&this.gl.deleteProgram(this.program)}getMemoryStats(){const t={webglSupported:!!this.gl,usingCanvas2D:this.useCanvas2D,isRunning:this.isRunning,currentPattern:this.currentPattern,availablePatterns:this.getAvailablePatterns().length};if(this.gl&&this.gl.getExtension){const e=this.gl.getExtension("WEBGL_debug_renderer_info");e&&(t.renderer=this.gl.getParameter(e.UNMASKED_RENDERER_WEBGL))}return t}}const m={ANXIETY_RELIEF:"anxiety_relief",CONFIDENCE_BOOST:"confidence_boost",AUTHORITY_BALANCE:"authority_balance",ALPHA_RELAXATION:"alpha",THETA_MEDITATION:"theta",DELTA_SLEEP:"delta",BETA_FOCUS:"beta",GAMMA_AWARENESS:"gamma",SCHUMANN_RESONANCE:"schumann",LIBERATION_FROM_FEAR:"solfeggio_396",LOVE_AND_HEALING:"solfeggio_528",AWAKENING_INTUITION:"solfeggio_741"};class f{constructor(){this.engines=new Map,this.maxEngines=3}createEngine(t){const e=document.getElementById(t);if(!e)throw new Error(`Canvas with id '${t}' not found`);if(this.engines.size>=this.maxEngines){const n=this.engines.keys().next().value;this.engines.get(n).cleanup(),this.engines.delete(n)}const i=new u(e);return this.engines.set(t,i),i}getEngine(t){return this.engines.get(t)}removeEngine(t){const e=this.engines.get(t);e&&(e.cleanup(),this.engines.delete(t))}cleanup(){this.engines.forEach(t=>t.cleanup()),this.engines.clear()}getMemoryStats(){const t={activeEngines:this.engines.size,maxEngines:this.maxEngines,engines:{}};return this.engines.forEach((e,i)=>{t.engines[i]=e.getMemoryStats()}),t}}const d=new f;export{m as T,d as g};
