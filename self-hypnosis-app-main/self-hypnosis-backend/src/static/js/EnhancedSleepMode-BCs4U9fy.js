var C=(o,m,g)=>new Promise((p,y)=>{var i=c=>{try{f(g.next(c))}catch(l){y(l)}},x=c=>{try{f(g.throw(c))}catch(l){y(l)}},f=c=>c.done?p(c.value):Promise.resolve(c.value).then(i,x);f((g=g.apply(o,m)).next())});import{j as e,B as L}from"../assets/index-BKYWQTDL.js";import{r,M as v,T as ie,V as re,W as z,a as se,b as oe,P as le,B as ce}from"./ui-vendor-BlhBEYGa.js";import{C as A,a as I,b as P,c as U,B as R,d as ue}from"./badge-D77RBqCt.js";import{S as W,L as de}from"./LightFrequencyTherapy-BzVf3EcC.js";import{P as me}from"./progress-B8H4JCGg.js";import{a as $,m as G,T as fe,b as pe,c as O,d as Y}from"./api-DWFtRO9k.js";import{g as ye}from"./therapeutic-content-J_xzvB3G.js";import"./react-vendor-DusaJeda.js";import"./performance-utils-CCFKMyI6.js";import"./index-P2oMkgOm.js";import"./index-58yVllA0.js";import"./index-B0WkjEv8.js";import"./light-frequency-xnzFdpxw.js";import"./index-BZ3-ktAF.js";function Te({userProfile:o,addSessionToHistory:m,updateProfile:g}){var F,B;const[p,y]=r.useState(!1),[i,x]=r.useState(null),[f,c]=r.useState(((F=o==null?void 0:o.preferences)==null?void 0:F.audioVolume)||.5),[l,H]=r.useState(((B=o==null?void 0:o.preferences)==null?void 0:B.sessionDuration)||30),[J,N]=r.useState(0),[K,w]=r.useState(0),[h,T]=r.useState([]),[Q,V]=r.useState(!0),[D,_]=r.useState(null),s=r.useRef(null),b=r.useRef(null),u=r.useRef(null),d=r.useRef(null),j=r.useRef(null);r.useEffect(()=>{E()},[]);const E=()=>C(null,null,function*(){try{V(!0),_(null);let t;try{const a=yield $.getTherapeuticContent({content_type:"subliminal,affirmation,frequency"});t=a.content||a}catch(a){console.warn("API unavailable, using mock data:",a),t=G.therapeuticContent.filter(n=>["subliminal","affirmation","frequency"].includes(n.content_type))}T(t)}catch(t){console.error("Error loading therapeutic content:",t),_("Failed to load therapeutic content"),T(G.therapeuticContent.filter(a=>["subliminal","affirmation","frequency"].includes(a.content_type)))}finally{V(!1)}}),X=()=>{const t=ye();return[{id:"personalized_affirmations",name:"Personalized Affirmations",description:"Subliminal affirmations based on your identified fear patterns",type:"subliminal",frequency:null,duration:"Custom",audioUrl:"/audio/authority_confidence_affirmations.wav",available:!0,content:h.find(n=>n.content_type==="affirmation"&&n.category==="authority")},{id:"sovereignty_activation",name:"Sovereignty Activation",description:"Deep programming for personal sovereignty and equality",type:"subliminal",frequency:null,duration:"15 min",audioUrl:"/audio/sovereignty_activation.wav",available:!0,content:h.find(n=>n.content_type==="affirmation"&&n.category==="sovereignty")},{id:"theta_programming",name:"Theta Programming",description:"Deep belief change in theta brainwave state (4-8 Hz)",type:"theta_wave",frequency:"6 Hz",duration:"30 min",audioUrl:"/audio/theta_programming.wav",available:!0,content:h.find(n=>n.content_type==="subliminal")},{id:"rife_frequency_healing",name:"Rife Frequency Healing",description:"Healing frequencies for emotional balance (528 Hz)",type:"frequency",frequency:"528 Hz",duration:"20 min",audioUrl:"/audio/rife_frequency_healing.wav",available:!0,content:h.find(n=>n.content_type==="frequency")},{id:"somatic_body_scan",name:"Somatic Body Scan",description:"Guided body awareness for nervous system regulation",type:"meditation",frequency:null,duration:"15 min",audioUrl:"/audio/somatic_body_scan.wav",available:!0,content:h.find(n=>n.category==="somatic")},{id:"polyvagal_safety",name:"Polyvagal Safety",description:"Nervous system safety and connection activation",type:"meditation",frequency:null,duration:"12 min",audioUrl:"/audio/polyvagal_safety.wav",available:!0,content:h.find(n=>n.category==="polyvagal")},{id:"core_sovereignty",name:"Core Sovereignty Declarations",description:"Fundamental affirmations for establishing personal sovereignty",type:"affirmation",frequency:null,duration:"3 min",audioUrl:"/audio/expanded_sovereignty_core.wav",available:!0,content:t.find(n=>n.title==="Core Sovereignty Declarations"),isNew:!0},{id:"inner_authority_activation",name:"Inner Authority Activation",description:"Activating your inner wisdom and authentic self-expression",type:"affirmation",frequency:null,duration:"3 min",audioUrl:"/audio/expanded_inner_authority.wav",available:!0,content:t.find(n=>n.title==="Inner Authority Activation"),isNew:!0},{id:"authority_body_scan",name:"Authority Trigger Body Scan",description:"Body-based healing for authority-related tension and trauma",type:"meditation",frequency:null,duration:"8 min",audioUrl:"/audio/expanded_authority_body_scan.wav",available:!0,content:t.find(n=>n.title==="Authority Trigger Body Scan"),isNew:!0},{id:"nervous_system_pendulation",name:"Nervous System Pendulation",description:"Teaching your nervous system to move between activation and calm",type:"meditation",frequency:null,duration:"10 min",audioUrl:"/audio/expanded_nervous_system_pendulation.wav",available:!0,content:t.find(n=>n.title==="Nervous System Pendulation"),isNew:!0},{id:"ventral_vagal_activation",name:"Ventral Vagal Activation",description:"Activating your social engagement system for confident interactions",type:"meditation",frequency:null,duration:"8 min",audioUrl:"/audio/expanded_ventral_vagal_activation.wav",available:!0,content:t.find(n=>n.title==="Ventral Vagal Activation for Authority Confidence"),isNew:!0},{id:"authority_fearful_part",name:"Meeting Your Authority-Fearful Part",description:"Connecting with and healing the part that fears authority",type:"meditation",frequency:null,duration:"12 min",audioUrl:"/audio/expanded_ifs_authority_fearful.wav",available:!0,content:t.find(n=>n.title==="Meeting Your Authority-Fearful Part"),isNew:!0},{id:"deep_sovereignty_subliminal",name:"Deep Sovereignty Programming",description:"Subconscious programming for deep sovereignty and self-authority",type:"subliminal",frequency:"6 Hz Theta",duration:"30 min",audioUrl:null,available:!0,content:t.find(n=>n.title==="Deep Sovereignty Programming"),isNew:!0},{id:"authority_confidence_subliminal",name:"Authority Confidence Subliminal",description:"Building unconscious confidence in authority interactions",type:"subliminal",frequency:"10 Hz Alpha",duration:"25 min",audioUrl:null,available:!0,content:t.find(n=>n.title==="Authority Confidence Subliminal"),isNew:!0},{id:"fear_release_subliminal",name:"Authority Fear Release",description:"Deep subconscious release of authority-related fears",type:"subliminal",frequency:"2 Hz Delta",duration:"20 min",audioUrl:null,available:!0,content:t.find(n=>n.title==="Authority Fear Release"),isNew:!0}].filter(n=>n.available)},Z=t=>C(null,null,function*(){try{if(p&&(i==null?void 0:i.id)===t.id){q();return}if(q(),x(t),y(!0),N(l*60),w(0),t.audioUrl)try{s.current=new Audio(t.audioUrl),s.current.volume=f,s.current.loop=!0,s.current.addEventListener("canplaythrough",()=>{s.current.play().catch(console.error)}),s.current.addEventListener("error",()=>{console.warn("Audio file not available, generating tone"),S(t)}),s.current.load()}catch(a){console.warn("Audio playback failed, generating tone:",a),S(t)}else S(t);ee();try{yield $.createSession({user_id:(o==null?void 0:o.id)||1,session_type:"sleep_mode",module_used:t.id,duration_minutes:l,completion_status:"in_progress"})}catch(a){console.warn("Failed to log session start:",a)}}catch(a){console.error("Error playing audio:",a),_("Failed to start audio session"),y(!1),x(null)}}),S=t=>{try{b.current||(b.current=new(window.AudioContext||window.webkitAudioContext));const a=b.current;a.state==="suspended"&&a.resume(),u.current=a.createOscillator(),d.current=a.createGain(),u.current.connect(d.current),d.current.connect(a.destination);let n=440;if(t.frequency){const M=t.frequency.match(/(\d+(?:\.\d+)?)/);M&&(n=parseFloat(M[1]))}u.current.frequency.setValueAtTime(n,a.currentTime),u.current.type="sine",d.current.gain.setValueAtTime(f*.1,a.currentTime),u.current.start()}catch(a){console.error("Error generating tone:",a)}},q=()=>{if(s.current&&(s.current.pause(),s.current.currentTime=0,s.current=null),u.current){try{u.current.stop(),u.current.disconnect()}catch(t){}u.current=null}d.current&&(d.current.disconnect(),d.current=null),j.current&&(clearInterval(j.current),j.current=null),y(!1),x(null),N(0),w(0)},k=t=>{const a=t[0];c(a),s.current&&(s.current.volume=a),d.current&&d.current.gain.setValueAtTime(a*.1,b.current.currentTime)},ee=()=>{const t=l*60;let a=0;j.current=setInterval(()=>{a+=1;const n=t-a;if(n<=0){q(),m==null||m({type:"sleep_mode",module:(i==null?void 0:i.name)||"Unknown",duration:l,completed:!0,timestamp:new Date().toISOString()});return}N(n),w(a/t*100)},1e3)},te=t=>{const a=Math.floor(t/60),n=t%60;return`${a}:${n.toString().padStart(2,"0")}`},ne=t=>{switch(t){case"subliminal":case"theta_wave":return e.jsx(ce,{className:"h-4 w-4"});case"frequency":return e.jsx(z,{className:"h-4 w-4"});case"meditation":return e.jsx(v,{className:"h-4 w-4"});default:return e.jsx(v,{className:"h-4 w-4"})}};if(Q)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-4 text-blue-600 animate-pulse"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Loading Sleep Mode..."}),e.jsx("p",{className:"text-gray-600",children:"Preparing your therapeutic audio content"})]})});if(D)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-4 text-red-600"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sleep Mode"}),e.jsx("p",{className:"text-red-600 mb-4",children:D}),e.jsx(L,{onClick:E,variant:"outline",children:"Retry Loading Content"})]})});const ae=X();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-4 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sleep Mode"}),e.jsx("p",{className:"text-gray-600",children:"Subconscious behavioral rewiring through subliminal audio programming"})]}),e.jsxs(A,{children:[e.jsx(I,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Session Settings"]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Session Duration: ",l," minutes"]}),e.jsx(W,{value:[l],onValueChange:t=>H(t[0]),min:5,max:120,step:5,className:"w-full",disabled:p})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Volume: ",Math.round(f*100),"%"]}),e.jsx(W,{value:[f],onValueChange:k,min:0,max:1,step:.1,className:"w-full"})]}),p&&i&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Playing: ",i.name]}),e.jsx("span",{children:te(J)})]}),e.jsx(me,{value:K,className:"w-full"})]})]})]}),e.jsxs(fe,{defaultValue:"audio",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2",children:[e.jsxs(O,{value:"audio",className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Audio Therapy"]}),e.jsxs(O,{value:"light",className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Light Frequency"]})]}),e.jsx(Y,{value:"audio",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:ae.map(t=>{var a;return e.jsxs(A,{className:`cursor-pointer transition-all ${(i==null?void 0:i.id)===t.id?"ring-2 ring-blue-500 bg-blue-50":"hover:shadow-md"}`,children:[e.jsxs(I,{className:"pb-3",children:[e.jsxs(P,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ne(t.type),t.name]}),e.jsxs("div",{className:"flex gap-2",children:[t.isNew&&e.jsx(R,{variant:"default",className:"text-xs bg-green-600",children:"NEW"}),t.frequency&&e.jsx(R,{variant:"secondary",className:"text-xs",children:t.frequency}),e.jsx(R,{variant:"outline",className:"text-xs",children:t.duration})]})]}),e.jsx(ue,{children:t.description})]}),e.jsxs(U,{children:[t.content&&e.jsxs("div",{className:"mb-3 p-2 bg-gray-50 rounded text-xs",children:[e.jsx("strong",{children:"Content Preview:"})," ",(a=t.content.content)==null?void 0:a.substring(0,100),"..."]}),e.jsx(L,{onClick:()=>Z(t),className:"w-full",variant:(i==null?void 0:i.id)===t.id&&p?"destructive":"default",children:(i==null?void 0:i.id)===t.id&&p?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Stop Session"]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Start Session"]})})]})]},t.id)})})}),e.jsx(Y,{value:"light",className:"space-y-4",children:e.jsx(de,{userProfile:o,onSessionComplete:t=>{m==null||m(t)}})})]}),e.jsx(A,{className:"border-amber-200 bg-amber-50",children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-amber-600 mt-1",children:"⚠️"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsx("strong",{children:"Safety Notice:"})," Sleep mode audio is designed for relaxation and subconscious programming. Use comfortable headphones at low volume. Discontinue if you experience any discomfort. This is not a substitute for professional medical or psychological treatment."]})]})})})]})}export{Te as default};
